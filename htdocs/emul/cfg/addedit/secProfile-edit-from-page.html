<?php
session_start();
?>
<HTML>
<HEAD>
    <TITLE>Security Profiles Configuration -Edit Entries.</TITLE>
    <LINK rel="stylesheet" href="../../orinoco/css/global.css">
    <SCRIPT src="../../orinoco/scripts/library.js"></SCRIPT>
    <SCRIPT src="../../orinoco/scripts/test.js"></SCRIPT>

</HEAD>
<BODY style="margin:0px" rightmargin="0" background="../../orinoco/images/bg.gif">
<SCRIPT language="javascript">
	grp_live = 1;
	subgrp_live = 9;
</SCRIPT>

<SCRIPT language="javascript" src="../../orinoco/scripts/menu.js"></SCRIPT>

<!-- Start Header -->
<!-- <BODY style="margin:0px"> -->
<TABLE width="100%" height="100%" cellpadding="0" cellspacing="0">
	<TR>
		<TD>
			<TABLE width="150" height="90" cellpadding="0" cellspacing="0">
			<TR>
			<TD valign="top"><IMG src="../../orinoco/images/logo.gif"></TD>
			</TR>
			<TR>
			<TD align="right">&nbsp;</TD>
			</TR>
			</TABLE>
		</TD>
		<TD valign="bottom">
			<TABLE cellpadding="0" cellspacing="0" width="100%"> <!-- For the table -->
				<!-- For the first row -->
				<TR>
					<TD>
						<TABLE class="tabrow" cellpadding="0" cellspacing="0">
							<SCRIPT language="javascript">
		                            		var ProductId  = "1.3.6.1.4.1.11898.2.4.12";													
                                                                var slotA = '4 ';
		                            		        var slotB = '6 ';
		                            		        var secModeA = '6';  
		                            		        var secModeB = '1';  
								InitMenu(ProductId, slotA, slotB, secModeA, secModeB);
								var nbrTabs = subNumArray[grp_live];
								if(nbrTabs>5)
								{
									var start,finish;
									var nbrTabsDivbyTwo = (nbrTabs - (nbrTabs%2))/2;
									if(subgrp_live >= (nbrTabsDivbyTwo + (nbrTabs%2)) )
									{
										start = 0;
										finish = nbrTabsDivbyTwo -1;
									}
									else
									{
										if ((nbrTabs %2)==0)
										{
											start = nbrTabsDivbyTwo;
											finish = nbrTabs-1;
										}
										else
										{
											start = nbrTabsDivbyTwo+1;
										finish = nbrTabs-1;
									}
										
									}
									drawTabRow(subgrpArray[grp_live],grp_live,subgrp_live,start,finish,1,1);
									document.write('<TD align="middle" background="../../orinoco/images/edge.gif">&nbsp;</TD>');
									document.write('</TABLE>');
									document.write('</TD>');
									document.write('</TR>');
									<!-- For the second row -->
									document.write('<TR>');
									document.write('<TD>');
									document.write('<TABLE class="tabrow" cellpadding="0" cellspacing="0">');
									if(subgrp_live >= (nbrTabsDivbyTwo+ (nbrTabs%2)))
									{
										start = nbrTabsDivbyTwo;
										finish = nbrTabs-1;
									}
									else
									{
										if ((nbrTabs %2)==0)
										{
											start = 0;
											finish = nbrTabsDivbyTwo-1;
										}
										else
										{
										start = 0;
											finish = nbrTabsDivbyTwo;
										}
									}
									drawTabRow(subgrpArray[grp_live],grp_live,subgrp_live,start,finish,2,0);
									document.write('<TD align="middle" background="../../orinoco/images/iedge.gif">&nbsp;</TD>');
								}
								else
								{
									drawTabRow(subgrpArray[grp_live],grp_live,subgrp_live,0,nbrTabs-1,0,0);
									document.write('<TD align="middle" background="../../orinoco/images/edge.gif">&nbsp;</TD>');
								}
							</SCRIPT>
						</TABLE>
					</TD>
				</TR>
			</TABLE>
		</TD>
	</TR>

	
	<TR>
		<TD valign="top">
			<TABLE align="center" cellpadding="10" cellspacing="0">
				<SCRIPT language="javascript">
					drawButtons(grp,grp_live);
				</SCRIPT>
			</TABLE>
		</TD>
<!-- End Header -->

<TD colspan="2" bgcolor="white" height="100%" valign="top">

<FORM method="post" name="securityEncryption" ACTION="../../handler/edit-from-page.php">
	<TABLE cellpadding="0" cellspacing="0" border="0" width="50%" style="margin-left:50px; margin-bottom:25; margin-top:5px">
		<TD>	
		<TR>
			<TD align="right" width="100%" colspan="3"><A href="javascript:window.history.back()"><IMG src="../../orinoco/images/back.gif" width="32" height="32" alt="Back" border="0"></A></TD>
		</TR>
		<TR>
			<TD colspan="3" class="header">Security Profile Table - Edit Entry</TD>
		</TR>
			<TR>
			<TD>&nbsp;</TD>
		</TR>

		<!-- Start Info Text -->
		<TR>
                    <TD colspan="3">
                        <TABLE border="0">
                            <TR>
                                <TD colspan="3" class="verbiage">
                                    <P>This page is used to edit a Security Profile.
                                    </P>
                                    <P>
                                    If the WEP security mode is configured, then the 
                                    appropriate key size must be configured. The access 
                                    point supports 64, 128, and 152 bit encryption keys. 
                                    The following table provides information on how to 
                                    configure encryption keys using HEX or ASCII values.
                                    </P>
                                </TD>
                            </TR>
                            <TR>
                                <TD>
                                    <center>
                                        <TABLE cellpadding="2" cellspacing="0" 
                                               border="1" width="90%">
                                            <TR>
                                                <TD>&nbsp;</TD>
                                                <TD>Configuration in Hex</TD>
                                                <TD>Configuration in ASCII</TD>
                                            </TR>
                                            <TR>
                                                <TD>64 bit encryption key</TD>
                                                <TD>10 characters (0-F)</TD>
                                                <TD>5 alphanumeric characters</TD>
                                            </TR>
                                            <TR>
                                                <TD>128 bit encryption key</TD>
                                                <TD>26 characters (0-F)</TD>
                                                <TD>13 alphanumeric characters</TD>
                                            </TR>
                                            <TR>
                                                <TD>152 bit encryption key</TD>
                                                <TD>32 characters (0-F)</TD>
                                                <TD>16 alphanumeric characters</TD>
                                            </TR>
                                        </TABLE>
                                    </center>
                                </TD>
                            </TR>
                            <TR>
                                <TD class="verbiage">
                                   <P>If the WPA/PSK or 802.11i/PSK security mode is configured, then the  
                                      appropriate PSK pass phrase must be configured. The
                                      PSK pass phrase consists of a alpha numeric string 
                                      from 8 to 63 characters.  
                                   </P> 
                               </TD>
                            </TR>
                            <TR>
                                <TD class="verbiage">
                                   <P> 802.1x, WPA or 802.11i security mode can be configured only if an EAP RADIUS server profile is configured and enabled. Certain security modes
                                   	and their combinations may not be available depending on the security capabilities of the wireless interface.
                                   </P> 
                               </TD>
                            </TR>                           
                            <TR>
                                <TD class="verbiage">
                                    <P><I>Note: Changes to these parameters require access 
                                          point reboot in order to take effect.</I></P>
                                </TD>
                            </TR>
                        </TABLE>
                    </TD>
                </TR>
                <?php
                $i = $_SESSION['value'];
                $checked = $_SESSION['sec'][$i]['name'];
                ?>
		 <tr border="1">
    <td>
        <input id="fakestaType_0x1" name="check" type="checkbox" value="none" <?php if ($checked == 'none') echo 'checked'?> ></input><i>Non Secure Station</i>
    </td>
    <td>Authentication Mode</td>
    <td>None
    </td>
</tr>
<tr><td></td>
    <td>Cipher</td>
    <td>None</td>
</tr>
<tr height="10px"></tr>
<tr><td>
        <input id="fakestaType_0x2" type="checkbox" value="wep" name="check" <?php if ($checked == 'wep') echo 'checked'?>></input>
        <i>WEP Station</i>
    </td>
    <td>Authentication Mode</td>
    <td>None</td>
    </tr>
<tr><td>
    </td>
    <td>Cipher</td>
    <td>WEP</td>
</tr>
<tr><td>
    </td>
    <td>Encryption Key 0</td>
    <td>
        <input id="key0_0x2" class="formtext" type="password" align="LEFT" size="80%" name="wep_key" value="<?php if ($checked == 'wep') echo $_SESSION['sec'][$i]['key'];?>"></input>
    </td>

</tr>
<tr><td>
    </td>
    <td>Encryption Transmit Key</td>
    <td>
        <select id="txkey_0x2" class="formdropdown" onchange="modify(this)" name="EmWeb_ns:snmp:109.0.2" disabled="">
            <option value="0" selected="">Key 0 </option>
        </select>
    </td>
</tr>
<tr height="10px"></tr>
<tr><td>
        <input id="fakestaType_0x4" type="checkbox" value="wpa_802.1x" name="check" <?php if ($checked == 'wpa_802.1x') echo 'checked'?>></input>
        <i> WPA Station</i>
    </td>
    <td>Authentication Mode</td>
    <td>802.1x</td>
</tr>
<tr><td>
    </td>
    <td>Cipher</td>
    <td>TKIP</td></tr>
    <tr height="10px"></tr>
<tr><td>
        <input id="fakestaType_0x5" type="checkbox" value="wpa_psk" name="check" <?php if ($checked == 'wpa_psk') echo 'checked'?>></input>
        <i>WPA-PSK Station</i>
    </td>
    <td> Authentication Mode</td>
    <td>PSK</td>
</tr>
<tr><td>
    </td>
    <td>Cipher</td>
    <td>TKIP</td>
</tr>
<tr height="10px"></tr>
<tr><td>
    </td>
    <td>PSK Passphrase </td>
    <td>
        <input id="PSKPassPhraseId_0x5" class="formtext" type="password" align="LEFT" size="80%" name="wpa_key" value="<?php if ($checked == 'wpa_psk') echo $_SESSION['sec'][$i]['key'];?>"></input>
    </td>
</tr>
<tr height="10px"></tr>
<tr><td>
        <input id="fakestaType_0x6" type="checkbox" value="wpa2_802.1x" name="check" <?php if ($checked == 'wpa2_802.1x') echo 'checked'?>></input>
        <i>802.11i Station</i>
    </td>
    <td>Authentication Mode</td>
    <td>802.1x</td>
</tr>
<tr><td>
    </td>
    <td>Cipher</td>
    <td>AES</td>
</tr>
<tr height="10px"></tr>
<tr><td>
        <input id="fakestaType_0x7" type="checkbox" value="wpa2_psk" name="check" <?php if ($checked == 'wpa2_psk') echo 'checked'?>></input>
        <i>802.11i-PSK Station</i>
    </td>
    <td>Authentication Mode</td>
    <td>PSK</td>
</tr>
<tr><td>
    </td>
    <td>Cipher</td>
    <td>AES</td>
</tr>
<tr><td>
    </td>
    <td>PSK Passphrase</td>
    <td><input id="PSKPassPhraseId_0x7" class="formtext" type="password" align="LEFT" size="80%" name="wpa2_key" value="<?php if ($checked == 'wpa2_psk') echo $_SESSION['sec'][$i]['key'];?>"></input>
    </td>
</tr>
<tr><td colspan="2">
        <img width="340" height="30" border="0" alt="" src="../../orinoco/images/spacer.gif"></img>
    </td>

</tr>
<tr>

    <td align="center">
        <input width="93" type="image" src="../../orinoco/images/ok.gif" height="25" value="ok" name="add"></input>
    </td>
    <td align="center">
        <a href="javascript:cancel()">
            <img width="93" height="25" border="0" alt="Cancel" src="../../orinoco/images/cancel.gif"></img></a>
    </td>
</tr>
	</TABLE>
	</TD> 
</TR>
</TABLE>
<?php 
                    if (isset($_SESSION['error']) && ($_SESSION['error'] == "1")){
                    echo "<script>alert(\"error\");</script>";
                    unset($_SESSION['error']);}
                    if (isset($_SESSION['error_key']) && ($_SESSION['error_key'] == "1")){
                    echo "<script>alert(\"error with key\");</script>";
                    unset($_SESSION['error_key']);}
                    ?>

</FORM></TD>
  <!-- Start Footer -->
	<FORM name="rebootform" method="post" ACTION="../../prototail.html">
		<INPUT type="hidden" id="rebootflag" name="EmWeb_ns:snmp:568" value="0" class="formtext">
	</FORM>

	</TR>
</TABLE>
</BODY>
</HTML>
<!-- End Footer -->

</BODY>
</HTML>
